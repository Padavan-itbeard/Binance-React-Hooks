{"version":3,"sources":["component/actions/actions.js","component/OrderBook/OrderBook.jsx","component/Select/Select.jsx","App.jsx","component/redusers/reducer.js","store.js","index.jsx"],"names":["fetchLoad","bool","type","payload","fetchError","err","OrderBook","useSelector","state","pair","interval","isLoad","isError","currPair","Err","replace","currArray","split","dispatch","useDispatch","useState","orders","setOrders","index","useEffect","a","url","axios","get","res","data","message","fetchLoadData","ws","WebSocket","toLowerCase","onopen","onmessage","event","JSON","parse","onerror","error","close","bids","asks","lastUpdateId","orderRows","arr","map","item","key","orderHead","title","colSpan","style","textAlign","marginTop","className","Select","optionsPair","optionsInterv","value","onChange","target","disabled","option","marginLeft","App","initialState","store","createStore","action","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9f1c7ba7.chunk.js","sourcesContent":["// не стал переносить на useReduce\n// будет нужно, перенесу\nexport const setPair = (newPair) => ({\n  type: 'SELECT_PAIR',\n  payload: newPair,\n});\n\nexport const setIntrvl = (newInt) => ({\n  type: 'SET_INTERVAL',\n  payload: newInt,\n});\n\nexport const fetchLoad = (bool) => ({\n  type: 'FETCH_LOAD',\n  payload: bool,\n});\n\nexport const fetchData = (obj) => ({\n  type: 'FETCH_DATA',\n  payload: obj,\n});\n\nexport const fetchError = (err) => ({\n  type: 'FETCH_ERROR',\n  payload: err,\n});\n","import React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport axios from 'axios';\nimport { fetchLoad, fetchError } from '../actions/actions';\nimport './OrderBook.css';\n\nconst OrderBook = () => {\n  const { pair, interval, isLoad, isError, Err } = useSelector((state) => state);\n  const currPair = pair.replace(/[/]/g, '');\n  const currArray = pair.split('/');\n  const dispatch = useDispatch();\n  const str = 'https://cors-anywhere.herokuapp.com/';\n  const [orders, setOrders] = useState([]);\n  let index = 0;\n\n  // на Thunk или Saga`у переносить не вижу смысла\n  // так же могу в промисах then, catch\n  useEffect(() => {\n    setOrders([]);\n    dispatch(fetchLoad(true));\n    dispatch(\n      fetchError({\n        isError: false,\n        Err: '',\n      }),\n    );\n    const fetchLoadData = async () => {\n      const url = `${str}https://www.binance.com/api/v1/depth?symbol=${currPair}&limit=10`;\n      try {\n        const res = await axios.get(url);\n        setOrders(res.data);\n      } catch (error) {\n        dispatch(\n          fetchError({\n            isError: true,\n            Err: error.message,\n          }),\n        );\n      } finally {\n        dispatch(fetchLoad(false));\n      }\n    };\n    fetchLoadData();\n  }, [pair]);\n\n  useEffect(() => {\n    // тут вопрос, если снапшот в ошибку вывалился, вебсокеты запускаем?\n    // если нет, то тут просто if (isError)\n    const ws = new WebSocket(`wss://stream.binance.com:9443/ws/${currPair.toLowerCase()}@depth10@${interval}`);\n\n    ws.onopen = () => {\n      dispatch(\n        fetchError({\n          isError: false,\n          Err: '',\n        }),\n      );\n    };\n    ws.onmessage = (event) => {\n      const res = JSON.parse(event.data);\n      setOrders(res);\n    };\n    // Выбивает в ошибку при переходе на др пару или интервал\n    // пробовал ставить паузу(была мысль, не успевает расконектится)\n    // не помогло\n    ws.onerror = (error) => {\n      dispatch(\n        fetchError({\n          isError: true,\n          Err: error.message,\n        }),\n      );\n    };\n    return () => {\n      ws.close();\n    };\n  }, [currPair, interval]);\n\n  const { bids, asks, lastUpdateId } = orders;\n  const orderRows = (arr) => arr\n    && arr.map((item) => (\n      <tr key={index++}>\n        <td>{item[1]}</td>\n        <td>{item[0]}</td>\n      </tr>\n    ));\n\n  const orderHead = (title) => (\n    <thead>\n      <tr>\n        <th colSpan=\"2\">{title}</th>\n      </tr>\n      <tr>\n        <th>\n          Amount (\n          {currArray[0]}\n          )\n        </th>\n        <th>\n          Price (\n          {currArray[1]}\n          )\n        </th>\n      </tr>\n    </thead>\n  );\n\n  return (\n    <>\n      {isLoad && <h2>Loading...</h2>}\n      {isError ? ( <h2>Loading...</h2>\n        // <>\n        //   <h2>Что то пошло не так..</h2>\n        //   <p>\n        //     Error:\n        //     {Err}\n        //   </p>\n        // </>\n      ) : (\n        <>\n          <div style={{ textAlign: 'center', marginTop: '1rem' }}>\n            lastUpdateId:\n            {lastUpdateId}\n          </div>\n          <div className=\"order-container\">\n            <table>\n              {orderHead('Bids')}\n              <tbody>{orderRows(bids)}</tbody>\n            </table>\n            <table>\n              {orderHead('Asks')}\n              <tbody>{orderRows(asks)}</tbody>\n            </table>\n          </div>\n        </>\n      )}\n    </>\n  );\n};\n\nexport default OrderBook;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport OrderBook from '../OrderBook/OrderBook';\nimport { setIntrvl, setPair } from '../actions/actions';\n\nconst Select = () => {\n  const optionsPair = ['ETC/USDT', 'XRP/USDT', 'BTS/USDT'];\n  const optionsInterv = ['1000ms', '100ms'];\n  const { pair, interval } = useSelector((state) => state);\n  const dispatch = useDispatch();\n\n  return (\n    <div style={{ textAlign: 'center' }}>\n      <span>Выберите пару: </span>\n      <select\n        value={pair}\n        onChange={(event) => dispatch(setPair(event.target.value))}\n      >\n        <option value=\"\" disabled>\n          ...\n        </option>\n        {optionsPair\n          && optionsPair.map((option) => (\n            <option key={option} value={option}>\n              {option}\n            </option>\n          ))}\n      </select>\n      <span style={{ marginLeft: '1rem' }}>Задайте интервал обновления: </span>\n      <select\n        value={interval}\n        onChange={(event) => dispatch(setIntrvl(event.target.value))}\n      >\n        {optionsInterv\n          && optionsInterv.map((option) => (\n            <option key={option} value={option}>\n              {option}\n            </option>\n          ))}\n      </select>\n      {pair && <OrderBook />}\n    </div>\n  );\n};\n\nexport default Select;\n","import React from 'react';\nimport Select from './component/Select/Select';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <h1>Ордербук криптовалютной биржи Binance</h1>\n      <Select />\n    </div>\n  );\n}\n\nexport default App;\n","// не стал переносить на useReduce\n// будет нужно, перенесу\nconst initialState = {\n  pair: '',\n  interval: '1000ms',\n  isLoad: false,\n  isError: false,\n  Err: '',\n};\n\nexport default function reducer(state = initialState, action) {\n  switch (action.type) {\n    case 'SELECT_PAIR':\n      return {\n        ...state,\n        pair: action.payload,\n      };\n    case 'SET_INTERVAL':\n      return {\n        ...state,\n        interval: action.payload,\n      };\n    case 'FETCH_LOAD':\n      return {\n        ...state,\n        isLoad: action.payload,\n      };\n    case 'FETCH_ERROR':\n      return {\n        ...state,\n        isError: action.payload.isError,\n        Err: action.payload.Err,\n      };\n    case 'LOAD_SNAP_SHOT':\n      return {\n        ...state,\n        bids: [...action.payload.bids],\n      };\n    default:\n      return state;\n  }\n}\n","import { createStore } from 'redux';\nimport reducer from './component/redusers/reducer';\n\nconst store = createStore(reducer);\n\nexport default store;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport './index.css';\nimport App from './App';\nimport store from './store';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}